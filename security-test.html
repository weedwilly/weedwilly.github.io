<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>Security Test Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding: 2rem; background-color: #f8f9fa; }
    .card { box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .result-box { white-space: pre-wrap; background: #fff; border: 1px solid #ccc; padding: 1rem; margin-top: 1rem; }
  </style>
</head>
<body>
  <h1 class="mb-4">ğŸ›¡ï¸ è³‡å®‰æ¸¬è©¦æŒ‘æˆ°é é¢</h1>

  <!-- XSS Test -->
  <div class="card mb-4">
    <div class="card-header">ğŸ§ª XSS æ¸¬è©¦</div>
    <div class="card-body">
      <input id="xssInput" class="form-control mb-2" placeholder="è¼¸å…¥å¯èƒ½çš„ XSS æ”»æ“Šç¢¼">
      <button class="btn btn-danger" onclick="runXSS()">é€å‡º</button>
      <div id="xssOutput" class="result-box"></div>
    </div>
  </div>

  <!-- Clickjacking Test -->
  <div class="card mb-4">
    <div class="card-header">ğŸ•µï¸ Clickjacking æ¸¬è©¦</div>
    <div class="card-body">
      <p>ä¸‹æ–¹ iframe å˜—è©¦åµŒå…¥ä¸»é ï¼š</p>
      <iframe src="https://weedwilly.github.io/" width="300" height="200" style="border:1px solid #ccc;"></iframe>
    </div>
  </div>

  <!-- Input Flooding Test -->
  <div class="card mb-4">
    <div class="card-header">ğŸŒŠ Input Flooding æ¸¬è©¦</div>
    <div class="card-body">
      <button class="btn btn-warning" onclick="flood()">å¤§é‡é€å‡º</button>
      <div id="floodStatus" class="text-muted mt-2"></div>
    </div>
  </div>

  <!-- CORS Test -->
  <div class="card mb-4">
    <div class="card-header">ğŸŒ CORS æ¸¬è©¦</div>
    <div class="card-body">
      <button class="btn btn-primary" onclick="testCORS()">æ¸¬è©¦è·¨ç¶²åŸŸè«‹æ±‚</button>
      <div id="corsResult" class="result-box"></div>
    </div>
  </div>

  <!-- CSP Test -->
  <div class="card mb-4">
    <div class="card-header">ğŸ”’ CSP æ¸¬è©¦</div>
    <div class="card-body">
      <p>è«‹ä½¿ç”¨ç€è¦½å™¨ DevTools æŸ¥çœ‹æ˜¯å¦æœ‰ <code>Content-Security-Policy</code> headersã€‚</p>
      <p>å»ºè­°ä½¿ç”¨ <a href="https://observatory.mozilla.org/" target="_blank">Mozilla Observatory</a> é€²è¡Œæƒæã€‚</p>
    </div>
  </div>

  <script>
    function runXSS() {
      const input = document.getElementById('xssInput').value;
      document.getElementById('xssOutput').innerHTML = input; // æ•…æ„ä½¿ç”¨ innerHTML
    }

    async function flood() {
      let count = 0;
      for (let i = 0; i < 100; i++) {
        await fetch('https://script.google.com/macros/s/ä½ çš„AppsScriptç¶²å€/exec', {
          method: 'POST',
          body: new URLSearchParams({ msg: 'flood ' + i })
        });
        count++;
        document.getElementById('floodStatus').textContent = `å·²é€å‡º ${count} ç­†è³‡æ–™`;
      }
    }

    async function testCORS() {
      try {
        const res = await fetch('https://ä½ çš„Supabaseæˆ–AppsScriptç¶²å€', {
          method: 'GET',
          mode: 'cors'
        });
        const text = await res.text();
        document.getElementById('corsResult').textContent = text;
      } catch (err) {
        document.getElementById('corsResult').textContent = 'éŒ¯èª¤ï¼š' + err;
      }
    }
  </script>
</body>
</html>
